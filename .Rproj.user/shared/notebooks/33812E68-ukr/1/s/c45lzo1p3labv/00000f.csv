"0","names(pesel) <- basename(fnames)"
"0","pesel_dt <- rbindlist(pesel, idcol = ""data"")"
"0","pesel_dt[, data:=str_extract(data, ""\\d{8}"")]"
"0",""
"0","pesel_dt_long <- melt(pesel_dt, id.vars = c(""data"", ""teryt"", ""pow"", ""woj""), value.name = ""counts"", variable.name = ""demo"")"
"0","pesel_dt_long[is.na(counts), counts:=1]"
"0","pesel_dt_long[, c(""plec"", ""wiek"") := tstrsplit(demo, ""_"")]"
"0","pesel_dt_long[, demo:=NULL]"
"0","pesel_dt_long[plec == ""kob"", plec := ""kobiety""]"
"0","pesel_dt_long[plec == ""mez"", plec := ""mezczyzni""]"
"0","pesel_dt_long[plec == ""tot"", plec := ""ogolem""]"
"0","pesel_dt_long[wiek == ""tot"", wiek := ""ogolem""]"
"0","pesel_dt_long[, data:=ymd(data)]"
"0","pesel_dt_long[plec == ""kobiety"" & wiek %in% 2022:2004, plec2:=""dziewczynki do 18""]"
"0","pesel_dt_long[plec == ""mezczyzni"" & wiek %in% 2022:2004, plec2:=""chłopcy do 18""]"
"0","pesel_dt_long[plec == ""mezczyzni"" & !wiek %in% 2022:2004, plec2:=""mężczyźni 18+""]"
"0","pesel_dt_long[plec == ""kobiety"" & !wiek %in% 2022:2004, plec2:=""kobiety 18+""]"
"0",""
"0","pesel_dt_long"
